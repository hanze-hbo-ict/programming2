<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Bart Barnard" /><link rel="canonical" href="https://bioinf.nl/~bbarnard/programming4/assignment4.html" />
      <link rel="shortcut icon" href="img/favicon.ico" />
    <title>4. Parallellisation - Programming 4</title>
    <link rel="stylesheet" href="css/theme.css" />
    <link rel="stylesheet" href="css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="css/extra.css" rel="stylesheet" />
        <link href="css/ansi-colours.css" rel="stylesheet" />
        <link href="css/jupyter-cells.css" rel="stylesheet" />
        <link href="css/pandas-dataframe.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "4. Parallellisation";
        var mkdocs_page_input_path = "assignment4.md";
        var mkdocs_page_url = "/~bbarnard/programming4/assignment4.html";
      </script>
    
    <!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="index.html" class="icon icon-home"> Programming 4
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="index.html">Introduction</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="assignment1.html">1. Static code analysis</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="assignment2.html">2. Multiple Class Interaction</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="assignment3.html">3. List comprehensions and generators</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">4. Parallellisation</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#assignment">Assignment</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="assignment5.html">5. Final assignment</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Programming 4</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">4. Parallellisation</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="assignment-4-parallellisation">Assignment 4: Parallellisation<a class="headerlink" href="#assignment-4-parallellisation" title="Permanent link">&para;</a></h1>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>In the plenairy part we have discussed how you can make use of Python's <a href="https://docs.python.org/3/library/multiprocessing.html"><code>multiprocessor</code> module</a> to distribute the computation of your problem over multiple cores on your CPU. We have seen how this increased performances when you are working with a lot of data, or when you need to do complex calculations.</p>
<p><img alt="The comparison of calculations in serial and multiprocessor mode" src="imgs/comparison-serial-mp.png" /></p>
<p>Even though the <code>multiprocessor</code> module is quite complex, the basic workings of it is quite simple. You provide your code with the number of cores you wish to use, some data you want to work with and a function that needs to be called for all the elements of your data. You use <a href="https://docs.python.org/3/library/functions.html#map">the function <code>map</code></a> for this minimal working example. For easy reference, the relevant portion of the code of the plenairy part is repeated below:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">multiprocessing</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mp</span>
<span class="k">with</span> <span class="n">mp</span><span class="o">.</span><span class="n">Pool</span><span class="p">()</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">sum_squared</span><span class="p">,</span> <span class="n">numbers</span><span class="p">)</span>
</code></pre></div>
<p>In this exercise, we are going to determine the fluctuation of CG-pairs over the genome of an organism. To do this, we need to count the amount of CG in (overlapping or non-overlapping) 'windows' (e.g. 10_000bp). We do this both in a sequential and in a non-sequential way, keeping track of the time it takes in both cases.</p>
<h2 id="assignment">Assignment<a class="headerlink" href="#assignment" title="Permanent link">&para;</a></h2>
<p>Download <a href="https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/000/005/845/GCF_000005845.2_ASM584v2/GCF_000005845.2_ASM584v2_genomic.fna.gz">the genome of the <em>E.coli</em></a>. Write a Python-program that accepts a command-line argument <code>-w, --window_size</code> that represents the window-size ðŸ¤¯ with which the program flows over the genome, returning the percentage of CG in that window:</p>
<div class="highlight"><pre><span></span><code>&gt;<span class="w"> </span>python<span class="w"> </span>count.py<span class="w"> </span>-w<span class="w"> </span>10_000<span class="w"> </span><span class="p">|</span><span class="w"> </span>head
<span class="m">00000</span>-10000:<span class="w"> </span><span class="m">0</span>.521
<span class="m">10000</span>-20000:<span class="w"> </span><span class="m">0</span>.499
<span class="m">20000</span>-30000:<span class="w"> </span><span class="m">0</span>.526
<span class="m">30000</span>-40000:<span class="w"> </span><span class="m">0</span>.532
<span class="m">40000</span>-50000:<span class="w"> </span><span class="m">0</span>.528
<span class="m">50000</span>-60000:<span class="w"> </span><span class="m">0</span>.516
<span class="m">60000</span>-70000:<span class="w"> </span><span class="m">0</span>.556
<span class="m">70000</span>-80000:<span class="w"> </span><span class="m">0</span>.536
<span class="m">80000</span>-90000:<span class="w"> </span><span class="m">0</span>.500
&gt;
</code></pre></div>
<p>Write the results to a csv-file. </p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="assignment3.html" class="btn btn-neutral float-left" title="3. List comprehensions and generators"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="assignment5.html" class="btn btn-neutral float-right" title="5. Final assignment">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p>Bart Barnard</p>
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="assignment3.html" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="assignment5.html" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="js/jquery-3.6.0.min.js"></script>
    <script>var base_url = ".";</script>
    <script src="js/theme_extra.js"></script>
    <script src="js/theme.js"></script>
      <script src="js/imgs.js"></script>
      <script src="js/matjax.js"></script>
      <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
